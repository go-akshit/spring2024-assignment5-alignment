WARNING:root:precomputed_leaderboard = 'auto'. But we have found no corresponding leaderboard
/home/c-akshit/miniconda3/envs/cs336_alignment/lib/python3.10/site-packages/datasets/load.py:1486: FutureWarning: The repository for tatsu-lab/alpaca_eval contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tatsu-lab/alpaca_eval
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
INFO:root:Evaluating the llama-3-8b-base outputs.
INFO:root:Creating the annotator from `scripts/alpaca_eval_vllm_llama3_70b_fn`.
INFO:root:Saving annotations to `scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json`.
Annotation chunk:   0%|          | 0/7 [00:00<?, ?it/s]INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn
INFO:root:vllm: loading model: /home/shared/Meta-Llama-3-70B-Instruct, tp=2, trust_remote_code=1
2024-06-09 23:22:04,016	INFO worker.py:1749 -- Started a local Ray instance.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<04:55,  2.32s/it, Generation Speed: 14.21 toks/s][A
Processed prompts:  10%|█         | 13/128 [00:04<00:36,  3.15it/s, Generation Speed: 90.77 toks/s][A
Processed prompts:  19%|█▉        | 24/128 [00:07<00:27,  3.82it/s, Generation Speed: 111.30 toks/s][A
Processed prompts:  27%|██▋       | 35/128 [00:09<00:22,  4.14it/s, Generation Speed: 121.75 toks/s][A
Processed prompts:  36%|███▌      | 46/128 [00:11<00:19,  4.28it/s, Generation Speed: 127.36 toks/s][A
Processed prompts:  45%|████▍     | 57/128 [00:13<00:14,  4.78it/s, Generation Speed: 136.92 toks/s][A
Processed prompts:  45%|████▌     | 58/128 [00:14<00:16,  4.29it/s, Generation Speed: 132.12 toks/s][A
Processed prompts:  51%|█████     | 65/128 [00:16<00:14,  4.22it/s, Generation Speed: 132.33 toks/s][A
Processed prompts:  52%|█████▏    | 66/128 [00:16<00:16,  3.75it/s, Generation Speed: 128.46 toks/s][A
Processed prompts:  59%|█████▉    | 76/128 [00:18<00:10,  4.95it/s, Generation Speed: 137.76 toks/s][A
Processed prompts:  60%|██████    | 77/128 [00:19<00:13,  3.92it/s, Generation Speed: 131.83 toks/s][A
Processed prompts:  69%|██████▉   | 88/128 [00:21<00:09,  4.23it/s, Generation Speed: 134.06 toks/s][A
Processed prompts:  76%|███████▌  | 97/128 [00:24<00:07,  4.02it/s, Generation Speed: 132.89 toks/s][A
Processed prompts:  84%|████████▍ | 108/128 [00:25<00:04,  4.71it/s, Generation Speed: 138.14 toks/s][A
Processed prompts:  85%|████████▌ | 109/128 [00:26<00:04,  4.13it/s, Generation Speed: 135.09 toks/s][A
Processed prompts:  94%|█████████▍| 120/128 [00:28<00:01,  5.02it/s, Generation Speed: 140.43 toks/s][A
Processed prompts:  95%|█████████▍| 121/128 [00:28<00:01,  4.45it/s, Generation Speed: 138.25 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:28<00:00,  4.43it/s, Generation Speed: 146.22 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  14%|█▍        | 1/7 [01:50<11:01, 110.22s/it]INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<04:56,  2.33s/it, Generation Speed: 14.14 toks/s][A
Processed prompts:   9%|▊         | 11/128 [00:04<00:44,  2.60it/s, Generation Speed: 75.47 toks/s][A
Processed prompts:  16%|█▌        | 20/128 [00:06<00:31,  3.44it/s, Generation Speed: 98.08 toks/s][A
Processed prompts:  16%|█▋        | 21/128 [00:07<00:34,  3.07it/s, Generation Speed: 92.88 toks/s][A
Processed prompts:  23%|██▎       | 30/128 [00:08<00:22,  4.28it/s, Generation Speed: 113.10 toks/s][A
Processed prompts:  24%|██▍       | 31/128 [00:09<00:29,  3.31it/s, Generation Speed: 103.25 toks/s][A
Processed prompts:  31%|███▏      | 40/128 [00:11<00:19,  4.47it/s, Generation Speed: 118.07 toks/s][A
Processed prompts:  32%|███▏      | 41/128 [00:12<00:25,  3.43it/s, Generation Speed: 109.55 toks/s][A
Processed prompts:  39%|███▉      | 50/128 [00:13<00:17,  4.38it/s, Generation Speed: 119.66 toks/s][A
Processed prompts:  41%|████      | 52/128 [00:14<00:20,  3.74it/s, Generation Speed: 115.62 toks/s][A
Processed prompts:  45%|████▌     | 58/128 [00:16<00:18,  3.86it/s, Generation Speed: 117.41 toks/s][A
Processed prompts:  46%|████▌     | 59/128 [00:17<00:21,  3.24it/s, Generation Speed: 113.29 toks/s][A
Processed prompts:  52%|█████▏    | 67/128 [00:19<00:18,  3.26it/s, Generation Speed: 112.65 toks/s][A
Processed prompts:  61%|██████    | 78/128 [00:21<00:11,  4.49it/s, Generation Speed: 122.11 toks/s][A
Processed prompts:  62%|██████▏   | 79/128 [00:21<00:12,  3.81it/s, Generation Speed: 118.61 toks/s][A
Processed prompts:  70%|██████▉   | 89/128 [00:24<00:09,  3.94it/s, Generation Speed: 120.32 toks/s][A
Processed prompts:  77%|███████▋  | 99/128 [00:26<00:07,  3.99it/s, Generation Speed: 121.57 toks/s][A
Processed prompts:  85%|████████▌ | 109/128 [00:27<00:03,  5.26it/s, Generation Speed: 129.84 toks/s][A
Processed prompts:  86%|████████▌ | 110/128 [00:29<00:04,  3.79it/s, Generation Speed: 123.48 toks/s][A
Processed prompts:  93%|█████████▎| 119/128 [00:31<00:02,  3.99it/s, Generation Speed: 124.81 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:31<00:00,  4.07it/s, Generation Speed: 134.23 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  29%|██▊       | 2/7 [02:22<05:20, 64.12s/it] INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<05:04,  2.40s/it, Generation Speed: 13.78 toks/s][A
Processed prompts:   9%|▉         | 12/128 [00:04<00:41,  2.81it/s, Generation Speed: 81.00 toks/s][A
Processed prompts:  19%|█▉        | 24/128 [00:07<00:27,  3.75it/s, Generation Speed: 107.77 toks/s][A
Processed prompts:  26%|██▌       | 33/128 [00:08<00:21,  4.46it/s, Generation Speed: 124.22 toks/s][A
Processed prompts:  27%|██▋       | 34/128 [00:09<00:26,  3.60it/s, Generation Speed: 113.11 toks/s][A
Processed prompts:  34%|███▍      | 44/128 [00:11<00:18,  4.57it/s, Generation Speed: 127.46 toks/s][A
Processed prompts:  35%|███▌      | 45/128 [00:12<00:22,  3.67it/s, Generation Speed: 118.87 toks/s][A
Processed prompts:  41%|████      | 52/128 [00:13<00:18,  4.18it/s, Generation Speed: 124.45 toks/s][A
Processed prompts:  41%|████▏     | 53/128 [00:14<00:23,  3.26it/s, Generation Speed: 116.82 toks/s][A
Processed prompts:  49%|████▉     | 63/128 [00:16<00:14,  4.46it/s, Generation Speed: 126.76 toks/s][A
Processed prompts:  50%|█████     | 64/128 [00:16<00:14,  4.43it/s, Generation Speed: 126.86 toks/s][A
Processed prompts:  51%|█████     | 65/128 [00:17<00:17,  3.52it/s, Generation Speed: 122.30 toks/s][A
Processed prompts:  58%|█████▊    | 74/128 [00:19<00:12,  4.47it/s, Generation Speed: 128.04 toks/s][A
Processed prompts:  59%|█████▊    | 75/128 [00:19<00:14,  3.70it/s, Generation Speed: 124.37 toks/s][A
Processed prompts:  66%|██████▋   | 85/128 [00:21<00:09,  4.66it/s, Generation Speed: 130.22 toks/s][A
Processed prompts:  67%|██████▋   | 86/128 [00:22<00:10,  3.88it/s, Generation Speed: 126.84 toks/s][A
Processed prompts:  73%|███████▎  | 94/128 [00:23<00:07,  4.33it/s, Generation Speed: 129.52 toks/s][A
Processed prompts:  74%|███████▍  | 95/128 [00:24<00:09,  3.57it/s, Generation Speed: 126.13 toks/s][A
Processed prompts:  80%|███████▉  | 102/128 [00:26<00:06,  3.92it/s, Generation Speed: 127.51 toks/s][A
Processed prompts:  81%|████████▏ | 104/128 [00:27<00:07,  3.42it/s, Generation Speed: 125.20 toks/s][A
Processed prompts:  88%|████████▊ | 113/128 [00:28<00:03,  4.38it/s, Generation Speed: 129.23 toks/s][A
Processed prompts:  90%|████████▉ | 115/128 [00:29<00:03,  3.76it/s, Generation Speed: 127.01 toks/s][A
Processed prompts:  97%|█████████▋| 124/128 [00:30<00:00,  5.66it/s, Generation Speed: 134.02 toks/s][A
Processed prompts:  99%|█████████▉| 127/128 [00:31<00:00,  5.52it/s, Generation Speed: 134.60 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:31<00:00,  4.11it/s, Generation Speed: 135.64 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  43%|████▎     | 3/7 [02:53<03:16, 49.23s/it]INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<05:01,  2.37s/it, Generation Speed: 13.90 toks/s][A
Processed prompts:  12%|█▏        | 15/128 [00:04<00:31,  3.57it/s, Generation Speed: 102.53 toks/s][A
Processed prompts:  20%|██        | 26/128 [00:06<00:21,  4.81it/s, Generation Speed: 134.62 toks/s][A
Processed prompts:  21%|██        | 27/128 [00:07<00:26,  3.83it/s, Generation Speed: 119.91 toks/s][A
Processed prompts:  28%|██▊       | 36/128 [00:09<00:20,  4.39it/s, Generation Speed: 130.45 toks/s][A
Processed prompts:  29%|██▉       | 37/128 [00:10<00:25,  3.52it/s, Generation Speed: 119.91 toks/s][A
Processed prompts:  40%|███▉      | 51/128 [00:11<00:13,  5.72it/s, Generation Speed: 146.66 toks/s][A
Processed prompts:  41%|████▏     | 53/128 [00:12<00:15,  4.71it/s, Generation Speed: 139.42 toks/s][A
Processed prompts:  49%|████▉     | 63/128 [00:13<00:11,  5.45it/s, Generation Speed: 148.55 toks/s][A
Processed prompts:  50%|█████     | 64/128 [00:14<00:14,  4.43it/s, Generation Speed: 141.59 toks/s][A
Processed prompts:  57%|█████▋    | 73/128 [00:16<00:11,  4.95it/s, Generation Speed: 146.51 toks/s][A
Processed prompts:  58%|█████▊    | 74/128 [00:17<00:13,  3.99it/s, Generation Speed: 140.22 toks/s][A
Processed prompts:  66%|██████▌   | 84/128 [00:18<00:09,  4.87it/s, Generation Speed: 146.16 toks/s][A
Processed prompts:  66%|██████▋   | 85/128 [00:19<00:10,  4.01it/s, Generation Speed: 141.21 toks/s][A
Processed prompts:  73%|███████▎  | 94/128 [00:21<00:07,  4.62it/s, Generation Speed: 144.61 toks/s][A
Processed prompts:  74%|███████▍  | 95/128 [00:22<00:08,  3.80it/s, Generation Speed: 140.13 toks/s][A
Processed prompts:  83%|████████▎ | 106/128 [00:24<00:04,  4.89it/s, Generation Speed: 145.76 toks/s][A
Processed prompts:  84%|████████▎ | 107/128 [00:24<00:05,  3.98it/s, Generation Speed: 141.51 toks/s][A
Processed prompts:  91%|█████████ | 116/128 [00:26<00:02,  4.61it/s, Generation Speed: 144.36 toks/s][A
Processed prompts:  91%|█████████▏| 117/128 [00:27<00:02,  3.88it/s, Generation Speed: 141.16 toks/s][A
Processed prompts:  99%|█████████▉| 127/128 [00:27<00:00,  6.32it/s, Generation Speed: 150.31 toks/s][A
Processed prompts: 100%|██████████| 128/128 [00:28<00:00,  5.28it/s, Generation Speed: 148.11 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:28<00:00,  4.49it/s, Generation Speed: 148.11 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  57%|█████▋    | 4/7 [03:22<02:03, 41.20s/it]INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<05:01,  2.38s/it, Generation Speed: 13.88 toks/s][A
Processed prompts:  10%|█         | 13/128 [00:04<00:37,  3.06it/s, Generation Speed: 88.32 toks/s][A
Processed prompts:  19%|█▉        | 24/128 [00:06<00:23,  4.37it/s, Generation Speed: 121.69 toks/s][A
Processed prompts:  20%|█▉        | 25/128 [00:07<00:28,  3.62it/s, Generation Speed: 110.86 toks/s][A
Processed prompts:  28%|██▊       | 36/128 [00:08<00:19,  4.84it/s, Generation Speed: 132.14 toks/s][A
Processed prompts:  29%|██▉       | 37/128 [00:09<00:22,  4.00it/s, Generation Speed: 123.47 toks/s][A
Processed prompts:  36%|███▌      | 46/128 [00:11<00:17,  4.57it/s, Generation Speed: 131.93 toks/s][A
Processed prompts:  37%|███▋      | 47/128 [00:12<00:20,  3.87it/s, Generation Speed: 125.79 toks/s][A
Processed prompts:  47%|████▋     | 60/128 [00:14<00:14,  4.55it/s, Generation Speed: 133.98 toks/s][A
Processed prompts:  56%|█████▋    | 72/128 [00:17<00:11,  4.80it/s, Generation Speed: 139.01 toks/s][A
Processed prompts:  64%|██████▍   | 82/128 [00:19<00:10,  4.49it/s, Generation Speed: 138.07 toks/s][A
Processed prompts:  73%|███████▎  | 94/128 [00:21<00:07,  4.82it/s, Generation Speed: 142.44 toks/s][A
Processed prompts:  74%|███████▍  | 95/128 [00:21<00:06,  4.81it/s, Generation Speed: 142.57 toks/s][A
Processed prompts:  84%|████████▍ | 108/128 [00:24<00:03,  5.05it/s, Generation Speed: 146.05 toks/s][A
Processed prompts:  95%|█████████▍| 121/128 [00:26<00:01,  5.60it/s, Generation Speed: 151.73 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:26<00:00,  4.86it/s, Generation Speed: 160.47 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  71%|███████▏  | 5/7 [03:49<01:11, 35.96s/it]INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<05:10,  2.44s/it, Generation Speed: 13.50 toks/s][A
Processed prompts:  10%|█         | 13/128 [00:04<00:31,  3.69it/s, Generation Speed: 102.87 toks/s][A
Processed prompts:  11%|█         | 14/128 [00:04<00:36,  3.16it/s, Generation Speed: 94.36 toks/s] [A
Processed prompts:  20%|██        | 26/128 [00:07<00:24,  4.15it/s, Generation Speed: 118.19 toks/s][A
Processed prompts:  29%|██▉       | 37/128 [00:09<00:20,  4.35it/s, Generation Speed: 126.63 toks/s][A
Processed prompts:  38%|███▊      | 48/128 [00:12<00:18,  4.41it/s, Generation Speed: 131.03 toks/s][A
Processed prompts:  48%|████▊     | 62/128 [00:13<00:11,  5.71it/s, Generation Speed: 151.25 toks/s][A
Processed prompts:  49%|████▉     | 63/128 [00:14<00:13,  4.68it/s, Generation Speed: 141.96 toks/s][A
Processed prompts:  60%|██████    | 77/128 [00:16<00:08,  6.21it/s, Generation Speed: 158.83 toks/s][A
Processed prompts:  61%|██████    | 78/128 [00:16<00:08,  6.13it/s, Generation Speed: 158.81 toks/s][A
Processed prompts:  62%|██████▏   | 79/128 [00:17<00:10,  4.83it/s, Generation Speed: 152.34 toks/s][A
Processed prompts:  70%|███████   | 90/128 [00:18<00:06,  6.10it/s, Generation Speed: 161.34 toks/s][A
Processed prompts:  71%|███████   | 91/128 [00:19<00:08,  4.46it/s, Generation Speed: 153.27 toks/s][A
Processed prompts:  80%|███████▉  | 102/128 [00:20<00:04,  5.83it/s, Generation Speed: 161.42 toks/s][A
Processed prompts:  81%|████████▏ | 104/128 [00:22<00:05,  4.51it/s, Generation Speed: 155.28 toks/s][A
Processed prompts:  88%|████████▊ | 113/128 [00:23<00:02,  5.36it/s, Generation Speed: 159.80 toks/s][A
Processed prompts:  90%|████████▉ | 115/128 [00:24<00:03,  4.18it/s, Generation Speed: 154.20 toks/s][A
Processed prompts:  98%|█████████▊| 126/128 [00:24<00:00,  7.09it/s, Generation Speed: 166.42 toks/s][A
Processed prompts: 100%|██████████| 128/128 [00:25<00:00,  5.71it/s, Generation Speed: 163.18 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:25<00:00,  4.94it/s, Generation Speed: 163.18 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  86%|████████▌ | 6/7 [04:15<00:32, 32.65s/it]INFO:root:Annotating 37 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/37 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   3%|▎         | 1/37 [00:02<01:25,  2.38s/it, Generation Speed: 13.88 toks/s][A
Processed prompts:  30%|██▉       | 11/37 [00:04<00:09,  2.61it/s, Generation Speed: 75.44 toks/s][A
Processed prompts:  54%|█████▍    | 20/37 [00:07<00:05,  3.21it/s, Generation Speed: 93.20 toks/s][A
Processed prompts:  78%|███████▊  | 29/37 [00:09<00:02,  3.44it/s, Generation Speed: 101.18 toks/s][A
Processed prompts: 100%|██████████| 37/37 [00:10<00:00,  4.17it/s, Generation Speed: 114.71 toks/s][AProcessed prompts: 100%|██████████| 37/37 [00:10<00:00,  3.47it/s, Generation Speed: 114.71 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk: 100%|██████████| 7/7 [04:26<00:00, 25.52s/it]Annotation chunk: 100%|██████████| 7/7 [04:26<00:00, 38.03s/it]
INFO:root:Saving all results to .
INFO:root:Not saving the result to the cached leaderboard because precomputed_leaderboard is not a path but <class 'NoneType'>.
[rank0]:[W CudaIPCTypes.cpp:16] Producer process has been terminated before all shared CUDA tensors released. See Note [Sharing CUDA tensors]
